# 第三章光栅图形学算法（裁剪）
- ## 裁剪
	- 背景： 使用计算机处理图形信息时，计算机内部存储的图形往往比较大,而屏幕显示的只是图形的一部分。因此需要确定图形哪些部分落在显示区之内，哪些落在显示区之外。这个选择的过程就称为 裁剪
	- ### 点的裁剪：
		- 对于任意一点P（x，y），若满足下列两对不等式
		- ![[Pasted image 20211027204938.png]]
		- 则点p在矩形窗口内；否则，点p在矩形窗口之外
	- ### 直线段的裁剪
		- 直线段和裁剪窗口的可能关系：
			- 完全落在窗口内
			- 完全落在窗口外
			- 与窗口边界相交
			- ![[Pasted image 20211027223214.png]]
			-  常用的裁剪算法有三种，即Cohen-Sutherland、中点分割法和Liang-Barsky裁剪算法
		-  Cohen-Sutherland算法
			-  本算法又称为编码裁剪算法，算法的基本思想是对每条直线段分三种情况处理：
				1. （简取）若端点p1和p2完全在裁剪窗口内：全部选取
				2. （简弃）若点p 1(x 1,y 1)和p 2(x 2,y 2)均在窗口外，且满足下列四个条件之一：
					-  ![[Pasted image 20211027223444.png]]
					-  舍弃
				3.  如果直线段既不满足“简取”的条件，也不满足“简弃”的条件
					- 需要对直线段按交点进行分段，分段后判断直线是“简取”还是“简弃”。
					- 每条线段的端点都赋以四位二进制码D 3D 2D 1D 0，编码规则如下：
					- ![[Pasted image 20211027224939.png]]
					- 上下右左
					- ![[Pasted image 20211027225018.png]]
					- 若两端点**或**运算为0，则可以简取
					- 若两端点**与**运算不为0，则可以简弃
					- 若以上条件都不成立 则需要求出与窗口边界交点，在交点处把线段一分为二
					- 小结：
						- Cohen-Sutherland算法用编码的方法实现了对直线段的裁剪
						- 编码的思想在图形学中甚至在计算机科学里也是非常重要的，一个很简单的思想可以带来很了不起的作用。
						- 比较适合两种情况：一是大部分线段完全可见；二是大部分线段完全不可见。
		- 中点分割算法
			- 对线段情况分类为三种：
				- 1.完全在窗口内 2.完全在窗口外 3. 和窗口有交点
			- 核心思想：通过二分逼近来确定直线段与窗口的交点
				-  若中点不在窗口内，则把中点和离窗口边界最 远 点 构 成 的 线 段 丢掉，以线段上的另一点和该中点再构成线段求其中点
				-  ![[Pasted image 20211028133134.png]]
				-  如中点在窗口内，则又以中点和最远点构成线段，并求其中点，直到中点与窗口边界的坐标值在规定的误差范围内相等
				-  ![[Pasted image 20211028133153.png]]
		-   Liang-Barsky算法
			-   主要思想：
				-   用参数方程表示一条直线
				-   ![[Pasted image 20211028133732.png]]
				-   把被裁剪的红色直线段看成是一条有方向的线段，把窗口的四条边分成两类：入边和出边[[1.jpg.png|入边和出边]]     裁剪结果的线段起点是直线和两条入边的交点以及始端点三个点里最靠近面的一个点，即参数u最大的那个点；裁剪线段的终点是和两条出边的交点以及端点最靠近面的一个点，取参数u最小的那个点。
				-   ![[Pasted image 20211028173143.png]]
				-   小结：
					-   1.直线段是有方向的 从入边进入 从出边离开
					-   2.直线参数化
						-   ![[Pasted image 20211028173550.png]]
					-   3.判断线段点是否在窗口内的不等式
						-   ![[Pasted image 20211028173631.png]]
					-   4.线段和窗口边界一共有四个交点
						-   ![[Pasted image 20211028173839.png]] 
	- ## 多边形的裁剪 
		- 目的：多边形裁剪算法输出的应该是裁剪后的多边形边界的顶点序列！
		- 需求：构造能产生一个或多个封闭区域的多边形裁剪算法
		- Sutherland-Hodgeman多边形裁剪
			- 算法思想：将多边形边界作为一个整体，每次用窗口的一条边对要裁剪的多边形和中间结果多边形进行裁剪，体现一种分而治之的思想
			- 四种情况的处理
			- ![[Pasted image 20211028174647.png]]
			- 因为从s点出发到p点，所以s点肯定在顶点表内，不需要再添加进表内
			- ![[Pasted image 20211028174654.png]]
			- 因为s点已经在顶点表内，不需要再填加到表内
			- ![[Pasted image 20211028174817.png]]
			- ![[Pasted image 20211028215550.png]]
	- ## 文字裁剪
		- 串精度裁剪 当字符串中的所有字符都在裁剪窗口内时，就全部保留它，否则舍弃整个字符串
		- 字符精度裁剪 在进行裁剪时，任何与窗口有重叠或落在窗口边界以外的字符都被裁剪掉
		- 壁画/像素精度裁剪 将笔划分解成直线段对窗口作裁剪。需判断字符串中各字符的哪些像素、笔划的哪一部分在窗口内，保留窗口内部分，裁剪掉窗口外的部分